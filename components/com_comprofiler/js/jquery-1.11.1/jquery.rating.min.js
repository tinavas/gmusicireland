window.jQuery&&function(e){if(!e.support.opacity&&!e.support.style)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}e.fn.rating=function(t){if(0==this.length)return this;if("string"==typeof arguments[0]){if(this.length>1){var i=arguments;return this.each(function(){e.fn.rating.apply(e(this),i)})}return e.fn.rating[arguments[0]].apply(this,e.makeArray(arguments).slice(1)||[]),this}var t=e.extend({},e.fn.rating.options,t||{});return e.fn.rating.calls++,this.not(".star-rating-applied").addClass("star-rating-applied").each(function(){var i,n=e(this),r=(this.name||"unnamed-rating").replace(/\[|\]/g,"_").replace(/^\_+|\_+$/g,""),a=e(this.form||document.body),o=a.data("rating");o&&o.call==e.fn.rating.calls||(o={count:0,call:e.fn.rating.calls});var s=o[r]||a.data("rating"+r);s&&(i=s.data("rating")),s&&i?i.count++:(i=e.extend({},t||{},(e.metadata?n.metadata():e.meta?n.data():null)||{},{count:0,stars:[],inputs:[]}),i.serial=o.count++,s=e('<span class="star-rating-control"/>'),n.before(s),s.addClass("rating-to-be-drawn"),(n.attr("disabled")||n.hasClass("disabled"))&&(i.readOnly=!0),n.hasClass("required")&&(i.required=!0),s.append(i.cancel=e('<div class="rating-cancel"><a title="'+i.cancel+'">'+i.cancelValue+"</a></div>").on("mouseover",function(){e(this).rating("drain"),e(this).addClass("star-rating-hover")}).on("mouseout",function(){e(this).rating("draw"),e(this).removeClass("star-rating-hover")}).on("click",function(){e(this).rating("select")}).data("rating",i)));var l=e('<div role="text" aria-label="'+this.title+'" class="star-rating rater-'+i.serial+'"><a title="'+(this.title||this.value)+'">'+this.value+"</a></div>");if(s.append(l),this.id&&l.attr("id",this.id),this.className&&l.addClass(this.className),i.half&&(i.split=2),"number"==typeof i.split&&i.split>0){var c=(e.fn.width?l.width():0)||i.starWidth,u=i.count%i.split,d=Math.floor(c/i.split);l.width(d).find("a").css({"margin-left":"-"+u*d+"px"})}i.readOnly?l.addClass("star-rating-readonly"):l.addClass("star-rating-live").on("mouseover",function(){e(this).rating("fill"),e(this).rating("focus")}).on("mouseout",function(){e(this).rating("draw"),e(this).rating("blur")}).on("click",function(){e(this).rating("select")}),this.checked&&(i.current=l),"A"==this.nodeName&&e(this).hasClass("selected")&&(i.current=l),n.hide(),n.on("change.rating",function(t){return t.selfTriggered?!1:(e(this).rating("select"),void 0)}),l.data("rating.input",n.data("rating.star",l)),i.stars[i.stars.length]=l[0],i.inputs[i.inputs.length]=n[0],i.rater=o[r]=s,i.context=a,n.data("rating",i),s.data("rating",i),l.data("rating",i),a.data("rating",o),a.data("rating"+r,s)}),e(".rating-to-be-drawn").rating("draw").removeClass("rating-to-be-drawn"),this},e.extend(e.fn.rating,{calls:0,focus:function(){var t=this.data("rating");if(!t)return this;if(!t.focus)return this;var i=e(this).data("rating.input")||e("INPUT"==this.tagName?this:null);t.focus&&t.focus.apply(i[0],[i.val(),e("a",i.data("rating.star"))[0]])},blur:function(){var t=this.data("rating");if(!t)return this;if(!t.blur)return this;var i=e(this).data("rating.input")||e("INPUT"==this.tagName?this:null);t.blur&&t.blur.apply(i[0],[i.val(),e("a",i.data("rating.star"))[0]])},fill:function(){var e=this.data("rating");return e?(e.readOnly||(this.rating("drain"),this.prevAll().addBack().filter(".rater-"+e.serial).addClass("star-rating-hover")),void 0):this},drain:function(){var e=this.data("rating");return e?(e.readOnly||e.rater.children().filter(".rater-"+e.serial).removeClass("star-rating-on").removeClass("star-rating-hover"),void 0):this},draw:function(){var t=this.data("rating");if(!t)return this;this.rating("drain");var i=e(t.current),n=i.length?i.prevAll().addBack().filter(".rater-"+t.serial):null;n&&n.addClass("star-rating-on"),t.cancel[t.readOnly||t.required?"hide":"show"](),this.siblings()[t.readOnly?"addClass":"removeClass"]("star-rating-readonly")},select:function(t,i){var n=this.data("rating");if(!n)return this;if(!n.readOnly){if(n.current=null,"undefined"!=typeof t||this.length>1){if("number"==typeof t)return e(n.stars[t]).rating("select",void 0,i);if("string"==typeof t)return e.each(n.stars,function(){e(this).data("rating.input").val()==t&&e(this).rating("select",void 0,i)}),this}else n.current="INPUT"==this[0].tagName?this.data("rating.star"):this.is(".rater-"+n.serial)?this:null;this.data("rating",n),this.rating("draw");var r=e(n.current?n.current.data("rating.input"):null),a=e(n.inputs).filter(":checked"),o=e(n.inputs).not(r);return o.prop("checked",!1),r.prop("checked",!0),e(r.length?r:a).trigger({type:"change",selfTriggered:!0}),(i||void 0==i)&&n.callback&&n.callback.apply(r[0],[r.val(),e("a",n.current)[0]]),this}},readOnly:function(t,i){var n=this.data("rating");return n?(n.readOnly=t||void 0==t?!0:!1,i?e(n.inputs).attr("disabled","disabled"):e(n.inputs).removeAttr("disabled"),this.data("rating",n),this.rating("draw"),void 0):this},disable:function(){this.rating("readOnly",!0,!0)},enable:function(){this.rating("readOnly",!1,!1)}}),e.fn.rating.options={cancel:"Cancel Rating",cancelValue:"",split:0,starWidth:16},e(function(){e("input[type=radio].star").rating()})}(jQuery);