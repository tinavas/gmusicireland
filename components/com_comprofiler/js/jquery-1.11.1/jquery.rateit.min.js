!function(e){function t(e){var t=e.originalEvent.changedTouches,i=t[0],n="";switch(e.type){case"touchmove":n="mousemove";break;case"touchend":n="mouseup";break;default:return}var r=document.createEvent("MouseEvent");r.initMouseEvent(n,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(r),e.preventDefault()}e.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}},e.fn.rateit=function(i,n){var r=1,o={},a="init",s=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};if(0===this.length)return this;var l=e.type(i);if("object"==l||void 0===i||null===i)o=e.extend({},e.fn.rateit.defaults,i);else{if("string"==l&&"reset"!==i&&void 0===n)return this.data("rateit"+s(i));"string"==l&&(a="setvalue")}return this.each(function(){var l=e(this),c=function(e,t){if(null!=t){var i="aria-value"+("value"==e?"now":e),n=l.find(".rateit-range");void 0!=n.attr(i)&&n.attr(i,t)}return arguments[0]="rateit"+s(e),l.data.apply(l,arguments)};if("reset"==i){var u=c("init");for(var d in u)l.data(d,u[d]);if(c("backingfld")){var p=e(c("backingfld"));p.val(c("value")),p.trigger("change"),p[0].min&&(p[0].min=c("min")),p[0].max&&(p[0].max=c("max")),p[0].step&&(p[0].step=c("step"))}l.trigger("reset")}l.hasClass("rateit")||l.addClass("rateit");var h="rtl"!=l.css("direction");if("setvalue"==a){if(!c("init"))throw"Can't set value before init";if("readonly"!=i||1!=n||c("readonly")||(l.find(".rateit-range").unbind(),c("wired",!1)),"value"==i&&(n=null==n?c("min"):Math.max(c("min"),Math.min(c("max"),n))),c("backingfld")){var p=e(c("backingfld"));"value"==i&&p.val(n),"min"==i&&p[0].min&&(p[0].min=n),"max"==i&&p[0].max&&(p[0].max=n),"step"==i&&p[0].step&&(p[0].step=n)}c(i,n)}if(!c("init")){if(c("min",isNaN(c("min"))?o.min:c("min")),c("max",isNaN(c("max"))?o.max:c("max")),c("step",c("step")||o.step),c("readonly",void 0!==c("readonly")?c("readonly"):o.readonly),c("resetable",void 0!==c("resetable")?c("resetable"):o.resetable),c("backingfld",c("backingfld")||o.backingfld),c("starwidth",c("starwidth")||o.starwidth),c("starheight",c("starheight")||o.starheight),c("value",Math.max(c("min"),Math.min(c("max"),isNaN(c("value"))?isNaN(o.value)?o.min:o.value:c("value")))),c("ispreset",void 0!==c("ispreset")?c("ispreset"):o.ispreset),c("backingfld")){var p=e(c("backingfld")).hide();if((p.attr("disabled")||p.attr("readonly"))&&c("readonly",!0),"INPUT"==p[0].nodeName&&("range"==p[0].type||"text"==p[0].type)&&(c("min",parseInt(p.attr("min"))||c("min")),c("max",parseInt(p.attr("max"))||c("max")),c("step",parseInt(p.attr("step"))||c("step"))),"SELECT"==p[0].nodeName&&p[0].options.length>1){c("min",isNaN(c("min"))?Number(p[0].options[0].value):c("min")),c("max",Number(p[0].options[p[0].length-1].value)),c("step",Number(p[0].options[1].value)-Number(p[0].options[0].value));var f=p.find("option[selected]");1==f.length&&c("value",f.val())}else c("value",p.val())}var m="DIV"==l[0].nodeName?"div":"span";r++;var g='<button id="rateit-reset-{{index}}" data-role="none" class="rateit-reset" aria-label="'+e.rateit.aria.resetLabel+'" aria-controls="rateit-range-{{index}}"></button><{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+e.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+c("min")+'" aria-valuemax="'+c("max")+'" aria-valuenow="'+c("value")+'"><{{element}} class="rateit-selected" style="height:'+c("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+c("starheight")+'px"></{{element}}></{{element}}>';l.append(g.replace(/{{index}}/gi,r).replace(/{{element}}/gi,m)),h||(l.find(".rateit-reset").css("float","right"),l.find(".rateit-selected").addClass("rateit-selected-rtl"),l.find(".rateit-hover").addClass("rateit-hover-rtl")),c("init",JSON.parse(JSON.stringify(l.data())))}l.find(".rateit-selected, .rateit-hover").height(c("starheight"));var v=l.find(".rateit-range");v.width(c("starwidth")*(c("max")-c("min"))).height(c("starheight"));var y="rateit-preset"+(h?"":"-rtl");if(c("ispreset")?l.find(".rateit-selected").addClass(y):l.find(".rateit-selected").removeClass(y),null!=c("value")){var b=(c("value")-c("min"))*c("starwidth");l.find(".rateit-selected").width(b)}var x=l.find(".rateit-reset");x.data("wired")!==!0&&x.bind("click",function(t){t.preventDefault(),x.blur();var i=e.Event("beforereset");return l.trigger(i),i.isDefaultPrevented()?!1:(l.rateit("value",null),l.trigger("reset"),void 0)}).data("wired",!0);var k=function(t,i){var n=i.changedTouches?i.changedTouches[0].pageX:i.pageX,r=n-e(t).offset().left;return h||(r=v.width()-r),r>v.width()&&(r=v.width()),0>r&&(r=0),b=Math.ceil(r/c("starwidth")*(1/c("step")))},w=function(e){var t=e*c("starwidth")*c("step"),i=v.find(".rateit-hover");if(i.data("width")!=t){v.find(".rateit-selected").hide(),i.width(t).show().data("width",t);var n=[e*c("step")+c("min")];l.trigger("hover",n).trigger("over",n)}},C=function(t){var i=e.Event("beforerated");return l.trigger(i,[t]),i.isDefaultPrevented()?!1:(c("value",t),c("backingfld")&&e(c("backingfld")).val(t).trigger("change"),c("ispreset")&&(v.find(".rateit-selected").removeClass(y),c("ispreset",!1)),v.find(".rateit-hover").hide(),v.find(".rateit-selected").width(t*c("starwidth")-c("min")*c("starwidth")).show(),l.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[t]),!0)};c("readonly")?x.hide():(c("resetable")||x.hide(),c("wired")||(v.bind("touchmove touchend",t),v.mousemove(function(e){var t=k(this,e);w(t)}),v.mouseleave(function(){v.find(".rateit-hover").hide().width(0).data("width",""),l.trigger("hover",[null]).trigger("over",[null]),v.find(".rateit-selected").show()}),v.mouseup(function(e){var t=k(this,e),i=t*c("step")+c("min");C(i),v.blur()}),v.keyup(function(e){(38==e.which||e.which==(h?39:37))&&C(Math.min(c("value")+c("step"),c("max"))),(40==e.which||e.which==(h?37:39))&&C(Math.max(c("value")-c("step"),c("min")))}),c("wired",!0)),c("resetable")&&x.show()),v.attr("aria-readonly",c("readonly"))})},e.fn.rateit.defaults={min:0,max:5,step:.5,starwidth:16,starheight:16,readonly:!1,resetable:!0,ispreset:!1},e(function(){e("div.rateit, span.rateit").rateit()})}(jQuery);