!function($){$.fn.editable=function(e,t){if("disable"==e)return $(this).data("disabled.editable",!0),void 0;if("enable"==e)return $(this).data("disabled.editable",!1),void 0;if("destroy"==e)return $(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable"),void 0;var n=$.extend({},$.fn.editable.defaults,{target:e},t),i=$.editable.types[n.type].plugin||function(){},o=$.editable.types[n.type].submit||function(){},r=$.editable.types[n.type].buttons||$.editable.types.defaults.buttons,a=$.editable.types[n.type].content||$.editable.types.defaults.content,s=$.editable.types[n.type].element||$.editable.types.defaults.element,l=$.editable.types[n.type].reset||$.editable.types.defaults.reset,c=n.callback||function(){},u=n.onedit||function(){},p=n.onsubmit||function(){},d=n.onreset||function(){},h=n.onerror||l;return n.tooltip&&$(this).attr("title",n.tooltip),n.autowidth="auto"==n.width,n.autoheight="auto"==n.height,this.each(function(){var e=this,t=$(e).width(),f=$(e).height();$(this).data("event.editable",n.event),$.trim($(this).html())||$(this).html(n.placeholder),$(this).bind(n.event,function(d){if(!0!==$(this).data("disabled.editable")&&!e.editing&&!1!==u.apply(this,[n,e])){d.preventDefault(),d.stopPropagation(),n.tooltip&&$(e).removeAttr("title"),0==$(e).width()?(n.width=t,n.height=f):("none"!=n.width&&(n.width=n.autowidth?$(e).width():n.width),"none"!=n.height&&(n.height=n.autoheight?$(e).height():n.height)),$(this).html().toLowerCase().replace(/(;|"|\/)/g,"")==n.placeholder.toLowerCase().replace(/(;|"|\/)/g,"")&&$(this).html(""),e.editing=!0,e.revert=$(e).html(),$(e).html("");var g=$("<form />");n.cssclass&&("inherit"==n.cssclass?g.attr("class",$(e).attr("class")):g.attr("class",n.cssclass)),n.style&&("inherit"==n.style?(g.attr("style",$(e).attr("style")),g.css("display",$(e).css("display"))):g.attr("style",n.style));var m,v=s.apply(g,[n,e]);if(n.loadurl){var b=setTimeout(function(){v.disabled=!0,a.apply(g,[n.loadtext,n,e])},100),y={};y[n.id]=e.id,$.isFunction(n.loaddata)?$.extend(y,n.loaddata.apply(e,[e.revert,n])):$.extend(y,n.loaddata),$.ajax({type:n.loadtype,url:n.loadurl,data:y,async:!1,success:function(e){window.clearTimeout(b),m=e,v.disabled=!1}})}else n.data?(m=n.data,$.isFunction(n.data)&&(m=n.data.apply(e,[e.revert,n]))):m=e.revert;a.apply(g,[m,n,e]),v.attr("name",n.name),r.apply(g,[n,e]),$(e).append(g),i.apply(g,[n,e]),$(":input:visible:enabled:first",g).focus(),n.select&&v.select(),v.keydown(function(t){27==t.keyCode&&(t.preventDefault(),l.apply(g,[n,e]))});var b;"cancel"==n.onblur?v.blur(function(){b=setTimeout(function(){l.apply(g,[n,e])},500)}):"submit"==n.onblur?v.blur(function(){b=setTimeout(function(){g.submit()},200)}):$.isFunction(n.onblur)?v.blur(function(){n.onblur.apply(e,[v.val(),n])}):v.blur(function(){}),g.submit(function(t){if(b&&clearTimeout(b),t.preventDefault(),!1!==p.apply(g,[n,e])&&!1!==o.apply(g,[n,e]))if($.isFunction(n.target)){var i=n.target.apply(e,[v.val(),n]);$(e).html(i),e.editing=!1,c.apply(e,[e.innerHTML,n]),$.trim($(e).html())||$(e).html(n.placeholder)}else{var r={};r[n.name]=v.val(),r[n.id]=e.id,$.isFunction(n.submitdata)?$.extend(r,n.submitdata.apply(e,[e.revert,n])):$.extend(r,n.submitdata),"PUT"==n.method&&(r._method="put"),$(e).html(n.indicator);var a={type:"POST",data:r,dataType:"html",url:n.target,success:function(t){"html"==a.dataType&&$(e).html(t),e.editing=!1,c.apply(e,[t,n]),$.trim($(e).html())||$(e).html(n.placeholder)},error:function(t){h.apply(g,[n,e,t])}};$.extend(a,n.ajaxoptions),$.ajax(a)}return $(e).attr("title",n.tooltip),!1})}}),this.reset=function(t){this.editing&&!1!==d.apply(t,[n,e])&&($(e).html(e.revert),e.editing=!1,$.trim($(e).html())||$(e).html(n.placeholder),n.tooltip&&$(e).attr("title",n.tooltip))}})},$.editable={types:{defaults:{element:function(){var e=$('<input type="hidden"></input>');return $(this).append(e),e},content:function(e){$(":input:first",this).val(e)},reset:function(e,t){t.reset(this)},buttons:function(e,t){var n=this;if(e.submit){if(e.submit.match(/>$/))var i=$(e.submit).click(function(){"submit"!=i.attr("type")&&n.submit()});else{var i=$('<button type="submit" />');i.html(e.submit)}$(this).append(i)}if(e.cancel){if(e.cancel.match(/>$/))var o=$(e.cancel);else{var o=$('<button type="cancel" />');o.html(e.cancel)}$(this).append(o),$(o).click(function(){if($.isFunction($.editable.types[e.type].reset))var i=$.editable.types[e.type].reset;else var i=$.editable.types.defaults.reset;return i.apply(n,[e,t]),!1})}}},text:{element:function(e){var t=$("<input />");return"none"!=e.width&&t.width(e.width),"none"!=e.height&&t.height(e.height),t.attr("autocomplete","off"),$(this).append(t),t}},textarea:{element:function(e){var t=$("<textarea />");return e.rows?t.attr("rows",e.rows):"none"!=e.height&&t.height(e.height),e.cols?t.attr("cols",e.cols):"none"!=e.width&&t.width(e.width),$(this).append(t),t}},select:{element:function(){var e=$("<select />");return $(this).append(e),e},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}if($("select",this).children().each(function(){($(this).val()==json.selected||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")}),!settings.submit){var form=this;$("select",this).change(function(){form.submit()})}}}},addInputType:function(e,t){$.editable.types[e]=t}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery);