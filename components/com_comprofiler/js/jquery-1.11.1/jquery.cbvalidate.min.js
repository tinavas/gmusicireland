!function(e){var t=[],a={init:function(a){return this.each(function(){var i=this,n=e(i).data("cbvalidate");n||(n={},n.options=a,n.defaults=e.fn.cbvalidate.defaults,n.settings=e.extend(!0,{},n.defaults,n.options),n.element=e(i),n.settings.useData&&e.each(n.defaults,function(e){if("init"!=e&&"useData"!=e){var t=n.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1));"undefined"!=typeof t?n.settings[e]=t:(t=n.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),"undefined"!=typeof t&&(n.settings[e]=t))}}),n.element.triggerHandler("cbvalidate.init.before",[n]),n.settings.init&&(n.settings.messages&&e.extend(e.validator.messages,n.settings.messages),n.element.on("submit",function(t){var a=e(this).find('button[type="submit"][data-submit-text],input[type="submit"][data-submit-text]');a.each(function(){var t=e(this).data("submit-text"),a=null;e(this).prop("disabled",!0),e(this).is("input")?(a=e(this).val(),e(this).val(t)):(a=e(this).html(),e(this).html(t)),e(this).data("button-text",a)});var i=e(this).validate();i.cbIsFormSubmitting=!0;var s=i.form();if(i.cbIsFormSubmitting=!1,!s){a.each(function(){var t=e(this).data("button-text");e(this).prop("disabled",!1),e(this).is("input")?e(this).val(t):e(this).html(t),e(this).removeData("button-text")});var r=n.validate.errorList;if(r.length){var l=e(r[0].element),d=l.closest(".cbTabPane");if(d.length){var o=d.closest(".cbTabs");if(o.length){var c=o.data("cbtabs");c&&c.element.cbtabs("select",d.attr("id"))}}e.scrollTo(l,0,{axis:"y",offset:{top:-((e(window).outerHeight()-l.outerHeight())/2),left:0}})}i.focusInvalid(),t.preventDefault()}n.element.triggerHandler("cbvalidate.validate",[n,s])}),n.validate=n.element.validate({onsubmit:!1,ignoreTitle:!0,errorClass:"cbValidationMessage",validClass:"cbValidationMessage",ignore:'.cbValidationDisabled,.hidden,.disabled,.ignore,:disabled,[readonly],[type="hidden"]',cbIsFormSubmitting:!1,cbIsOnFocusOut:!1,cbIsOnKeyUp:!1,cbIsOnClick:!1,cbIsOnChange:!1,success:function(t,a){var i=n.validate.errorsFor(a);i.length>1&&i.not(t).remove();var s=e(a).data("remote-response");s||(s=e(a).data("msg-success")),s?(t.find(".cbValidationIcon").remove(),t.removeClass("text-danger"),t.html(s),"<"!=s.toString().charAt(0)&&(t.prepend('<span class="cbValidationIcon fa fa-check"></span>'),t.addClass("text-success"))):t.remove(),n.element.triggerHandler("cbvalidate.success",[n,t,a])},showErrors:function(t,a){var i=this;i.defaultShowErrors(),e.each(a,function(e,t){var a=i.errorsFor(t.element);a.length>1&&a.not(":last").remove(),a.find(".cbValidationIcon").remove(),a.removeClass("text-success"),"<"!=t.message.toString().charAt(0)&&(a.prepend('<span class="cbValidationIcon fa fa-times"></span>'),a.addClass("text-danger"))}),n.element.triggerHandler("cbvalidate.showerrors",[n,t,a])},highlight:function(t,a,i){e(t).addClass("cbValidationError"),e(t).closest(".cb_form_line").addClass("cbValidationError has-error"),e(t).closest("tr").addClass("cbValidationError has-error");var s=n.element.find(".cbTabs");s.length&&s.each(function(){var t=e(this).data("cbtabs");t&&e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(n.validate.settings.ignore);a.length&&t.tabNav.addClass("cbValidationError has-error")})}),n.element.triggerHandler("cbvalidate.highlight",[n,t,a,i])},unhighlight:function(t,a,i){e(t).removeClass("cbValidationError"),e(t).closest(".cb_form_line").removeClass("cbValidationError has-error"),e(t).closest("tr").removeClass("cbValidationError has-error");var s=n.element.find(".cbTabs");s.length&&s.each(function(){var t=e(this).data("cbtabs");t&&e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(n.validate.settings.ignore);a.length||t.tabNav.removeClass("cbValidationError has-error")})}),n.element.triggerHandler("cbvalidate.unhighlight",[n,t,a,i])},errorElement:"div",errorPlacement:function(e,t){var a=t.closest(".fieldCell,.cbFieldSpan,.cb_field");a.length?e.appendTo(a):e.insertAfter(t),n.element.triggerHandler("cbvalidate.errorplacement",[n,e,t])},onfocusout:function(e){this.cbIsOnFocusOut=!0,this.element(e),this.cbIsOnFocusOut=!1,n.element.triggerHandler("cbvalidate.focusout",[n,e])},onkeyup:function(e){this.cbIsOnKeyUp=!0,this.element(e),this.cbIsOnKeyUp=!1,n.element.triggerHandler("cbvalidate.keyup",[n,e])},onclick:function(e){this.cbIsOnClick=!0,this.element(e),this.cbIsOnClick=!1,n.element.triggerHandler("cbvalidate.click",[n,e])},onchange:function(e){this.cbIsOnChange=!0,this.element(e),this.cbIsOnChange=!1,n.element.triggerHandler("cbvalidate.change",[n,e])}}),n.element.validateDelegate("input,select,textarea","change",function(t){var a=e.data(this[0].form,"validator"),i="on"+t.type.replace(/^validate/,""),n=a.settings;n[i]&&!this.is(n.ignore)&&n[i].call(a,this[0],t)}),n.validate.options=n.settings,n.element.triggerHandler("cbvalidate.init.after",[n]),n.element.data("cbvalidate",n),t.push(n)))})},validate:function(t,a){var i=e(this).data("cbvalidate");if(!i)return!0;"undefined"==typeof t&&(t=null),"undefined"==typeof a&&(a=!1),i.validate.cbIsFormSubmitting=!0;var n=!0;if(t)if(a){var s=i.validate.currentForm;i.validate.currentForm=t;var r=i.validate.elements();i.validate.currentForm=s;var l=0;r.each(function(){var t=this;e.each(s,function(e,a){a==t&&(i.validate.element(a)||l++)})}),n=l?!1:!0}else n=i.validate.element(t);else n=i.validate.form();return i.validate.cbIsFormSubmitting=!1,n||i.validate.focusInvalid(),i.element.triggerHandler("cbvalidate.validate",[i,n]),n},reset:function(){var t=e(this).data("cbvalidate");return t?(t.validate.resetForm(),t.element.triggerHandler("cbvalidate.reset",[t]),!0):!1},invalid:function(){var t=e(this).data("cbvalidate");if(!t)return 0;var a=t.validate.numberOfInvalids();return t.element.triggerHandler("cbvalidate.invalid",[t,a]),a},focus:function(){var t=e(this).data("cbvalidate");return t?(t.validate.focusInvalid(),t.element.triggerHandler("cbvalidate.focus",[t]),!0):!1},valid:function(){var t=e(this).data("cbvalidate");if(!t)return!0;var a=t.validate.valid();return t.element.triggerHandler("cbvalidate.valid",[t,a]),a},elements:function(t){var a=e(this).data("cbvalidate");if(!a)return[];"undefined"==typeof t&&(t=null);var i=[];return i="invalid"==t?a.validate.invalidElements():"valid"==t?a.validate.validElements():a.validate.elements(),a.element.triggerHandler("cbvalidate.elements",[a,i]),i},errors:function(){var t=e(this).data("cbvalidate");if(!t)return[];var a=t.validate.errors();return t.element.triggerHandler("cbvalidate.errors",[t,a]),a},instances:function(){return t}};e.validator.addMethod("cbfield",function(t,a,i){var n=this.options;return i.method||(i.method="cbfield"),i.function||(i.function="checkvalue"),i.data={user:i.user,field:i.field,reason:i.reason,value:t},n.settings.cbfield.url&&(i.url=n.settings.cbfield.url),n.settings.cbfield.spooffield&&n.settings.cbfield.spooffield&&(i.data[n.settings.cbfield.spooffield]=n.settings.cbfield.spoofstring),n.settings.cbfield.spamfield&&n.settings.cbfield.spamstring&&(i.data[n.settings.cbfield.spamfield]=n.settings.cbfield.spamstring),e.validator.methods.cbremote.call(this,t,a,i)},"Please fix this field."),e.validator.addMethod("cbremote",function(t,a,i){if(e(a).data("remote-response",null),this.optional(a)||this.cbIsOnChange||this.cbIsFormSubmitting||!i.url)return!0;e.each(i,function(e,t){"object"!=typeof t&&"array"!=typeof t&&"url"!=e&&"data"!=e&&(i.url=i.url.replace("["+e+"]",t))});var n=this.previousValue(a),s=this;return this.settings.messages[a.name]||(this.settings.messages[a.name]={}),i.method||(i.method="cbremote"),n.originalMessage=this.settings.messages[a.name][i.method],this.settings.messages[a.name][i.method]=n.message,n.old===t?(e(a).data("remote-response",e(n).data("remote-response")),n.valid):this.cbIsOnKeyUp?!0:(n.old=t,e(n).data("remote-response",null),this.startRequest(a),e.ajax({url:i.url,type:"POST",mode:"abort",port:"validate"+a.name,dataType:"json",data:i.data,converters:{"text json":function(t){try{return e.parseJSON(t)}catch(a){return{valid:!0,message:t}}}},beforeSend:function(){e('<span class="cbSpinner fa fa-spinner fa-spin-fast fa-infix"></span>').insertAfter(e(a))}}).done(function(r){var l=r.valid===!0||"true"===r.valid,d={},o=null,c=null;s.settings.messages[a.name][i.method]=n.originalMessage,l?(e(a).data("remote-response",r.message),e(n).data("remote-response",r.message),c=s.formSubmitted,s.prepareElement(a),s.formSubmitted=c,s.successList.push(a),delete s.invalid[a.name],s.showErrors()):(o=r.message||s.defaultMessage(a,i.method),d[a.name]=n.message=e.isFunction(o)?o(t):o,s.invalid[a.name]=!0,s.showErrors(d)),n.valid=l,s.stopRequest(a,l)}).always(function(){e(a).siblings(".cbSpinner").remove()}),"pending")},"Please fix this field."),e.validator.addMethod("accept",function(t,a,i){var n="string"==typeof i?i.replace(/\s/g,"").replace(/,/g,"|"):"image/*",s=this.optional(a),r=null,l=null;if(s)return s;if("file"===e(a).attr("type")&&(n=n.replace(/\*/g,".*"),a.files&&a.files.length))for(r=0;r<a.files.length;r++)if(l=a.files[r],!l.type.replace(/mp3/,"mpeg").replace(/m4a/,"mp4").match(new RegExp(".?("+n+")$","i")))return!1;return!0},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("extension",function(e,t,a){return a="string"==typeof a?a.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp(".("+a+")$","i"))},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("maxWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length<=i},e.validator.format("Please enter {0} words or less.")),e.validator.addMethod("minWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length>=i},e.validator.format("Please enter at least {0} words.")),e.validator.addMethod("rangeWords",function(t,a,i){var n=e(t).text(),s=/\b\w+\b/g;return this.optional(a)||n.match(s).length>=i[0]&&n.match(s).length<=i[1]},e.validator.format("Please enter between {0} and {1} words.")),e.validator.addMethod("pattern",function(e,t,a){if(this.optional(t))return!0;if("string"==typeof a){var i=a.substr(0,1),n=a.lastIndexOf(i),s=a.slice(1,n),r=a.substr(n+1);s=s.replace(i+i,i),a=new RegExp(s,r)}return a.test(e)},"Invalid format."),e.validator.addMethod("cburl",function(e,t){return this.optional(t)||/^(?:(https?|ftp):\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},"Please enter a valid URL."),e.validator.addMethod("cbusername",function(e,t){return this.optional(t)||!/^\s+|[<>"'%;()&\\]|\.\.\/|\s+$/i.test(e)},"Please enter a valid username with no space at beginning or end and must not contain the following characters: < > \\ \" ' % ; ( ) &"),e.validator.addMethod("passwordstrength",function(t,a){var i=[/.{8,}/,/[A-Z]+/,/[a-z]+/,/\d+/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]+/,/.{12,}/,/[A-Z]{2,}/,/[a-z]{2,}/,/\d{2,}/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]{2,}/],n=0;e.each(i,function(e,a){t.match(a)&&n++}),n>i.length?n=i.length:0>n&&(n=0);var s=n*(100/i.length),r="cbPasswordStrengthStrong progress-bar-success";30>=s?r="cbPasswordStrengthVeryWeak progress-bar-danger":50>=s?r="cbPasswordStrengthWeak progress-bar-warning":70>=s&&(r="cbPasswordStrengthOk progress-bar-info");var l=e(a).outerWidth();if(e(a).is(":hidden")){var d=e(a).clone(!1).attr({id:"","class":""}).css({position:"absolute",display:"block",width:"auto",visibility:"hidden",padding:e(a).css("padding"),border:e(a).css("border"),margin:e(a).css("margin"),fontFamily:e(a).css("font-family"),fontSize:e(a).css("font-size"),fontWeight:e(a).css("font-weight"),boxSizing:e(a).css("box-sizing")}).appendTo("body");l=d.outerWidth(),d.remove()}return e(a).data("msg-success",'<div class="cbPasswordStrength progress" style="width: '+l+'px"><div class="cbPasswordStrengthBar progress-bar '+r+'" style="width: '+s+'%"></div></div>'),!0},""),e.fn.cbvalidate=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:a.init.apply(this,arguments)},e.fn.cbvalidate.defaults={init:!0,useData:!1,messages:null,settings:null}}(jQuery);