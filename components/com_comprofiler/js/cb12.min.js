function cbsaveorder(e,t,n,i,d,a){cbCheckAllRowsAndSubTask(e,t,n,d,a),cbsubmitform(i)}function cbCheckAllRowsAndSubTask(e,t,n,i,d){n||(n="cb"),f=cbParentForm(e);for(var a=0;t>a;a++)box=f.elements[n+a],0==box.checked&&(box.checked=!0);i&&d&&(f.elements[i].value=d)}function cbToggleAll(tgl,n,fldName){fldName||(fldName="cb");var frm=tgl.form,checked=0;for(i=0;n>i;i++)cb=eval("frm."+fldName+i),cb&&(cb.checked=tgl.checked,1==tgl.checked&&checked++);return"undefined"!=typeof frm.boxchecked&&(frm.boxchecked.value=checked),!0}function cbParentForm(e){var t;for(t=e==window?window.event.srcElement:e;t&&(t=t.parentNode,"FORM"!=t.nodeName););return t}function cbIsChecked(e){1==e?document.adminForm.boxchecked.value++:document.adminForm.boxchecked.value--}function cbListItemTask(e,t,n,d,a,r){var c=cbParentForm(e);if(e&&c){var s=new RegExp("^"+a+"[0-9]+$");for(i=0;i<c.elements.length;i++)cbx=c.elements[i],"checkbox"==cbx.type&&s.test(cbx.id)&&(cbx.checked=cbx.id==a+r?!0:!1);n&&d&&(c.elements[n].value=d),submitbutton(t)}return!1}function cbDoListTask(e,t,n,d,a){var r=document.forms.adminForm;if(e){var c=!1;for(i=0;!0&&(cbx=r.elements[a+i],cbx);i++)if(cbx.checked){c=!0;break}if(c){if(n&&d){if("deleterows"==d&&!confirm("Are you sure you want to delete selected items ?"))return!1;r.elements[n].value=d}submitbutton(t)}else alert("no items selected")}return!1}function cbDoSubTask(e,t,n,i){var d=document.forms.adminForm;return e&&(n&&i&&(d.elements[n].value=i),submitbutton(t)),!1}function cbhideMainMenu(){document.adminForm.hidemainmenu&&(document.adminForm.hidemainmenu.value=1)}function submitbutton(e){return cbsubmitform(e),!1}function cbsubmitform(e){if(-1==e.indexOf("="))document.forms.adminForm.elements.task?document.forms.adminForm.elements.task.value=e:document.forms.adminForm.elements.view&&(document.forms.adminForm.elements.view.value=e);else for(var t=e.split("&"),n=0;n<t.length;n++){var i=t[n].split("=");"undefined"==typeof document.forms.adminForm.elements[i[0]]&&"undefined"!=typeof cbjQuery&&cbjQuery('<input type="hidden" />').attr("name",i[0]).attr("value",i[1]).appendTo(cbjQuery(document.forms.adminForm)),document.forms.adminForm.elements[i[0]].value=i[1]}if("undefined"!=typeof cbjQuery)cbjQuery(document.forms.adminForm).submit();else{if("undefined"!=typeof document.forms.adminForm)try{document.forms.adminForm.onsubmit()}catch(d){}document.forms.adminForm.submit()}}function cbGetElementsByClass(e,t,n){var d=new Array;null==t&&(t=document),null==n&&(n="*");var a=t.getElementsByTagName(n),r=a.length,c=new RegExp("(^|\\s)"+e+"(\\s|$)");for(i=0,j=0;r>i;i++)c.test(a[i].className)&&(d[j]=a[i],j++);return d}function cbAddEvent(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!0),!0;if(e.attachEvent){var i=e.attachEvent("on"+t,n);return i}return!1}function cbAddEventObjArray(objArr,evType,fn){for(var j=0;j<objArr.length;j++)"hidden"!=objArr[j].type&&eval("objArr[j].on"+evType+"=fn")}function cbGetDisplayStyle(e){var t;return t=e.style.getPropertyValue?e.style.getPropertyValue("display"):e.style.display}function cbParamChange(){var e,t,n,i,d,a,r,c,s=new Array,l=new Array,o=!1;for(d=0;d<cbHideFields.length;d++){for(e="",a=1;a<cbSels[d].length;a++)if("hidden"!=cbSels[d][a].type)if("radio"==cbSels[d][a].type||"checkbox"==cbSels[d][a].type)cbSels[d][a].checked&&(e+=(""===e?"":"|*|")+cbSels[d][a].value);else if("SELECT"==cbSels[d][a].tagName)for(var u=cbSels[d][a].options.length,b=0;u>b;b++)cbSels[d][a].options[b].selected&&(e+=(""===e?"":"|*|")+cbSels[d][a].options[b].value);else e+=(""===e?"":"|*|")+cbSels[d][a].value;var m=!1;switch(cbHideFields[d][2]){case"==":e==cbHideFields[d][3]&&(m=!0);break;case"!=":e!=cbHideFields[d][3]&&(m=!0);break;case">=":e>=cbHideFields[d][3]&&(m=!0);break;case"<=":e<=cbHideFields[d][3]&&(m=!0);break;case">":e>cbHideFields[d][3]&&(m=!0);break;case"<":e<cbHideFields[d][3]&&(m=!0);break;case"contains":m=-1==e.indexOf(cbHideFields[d][3]);break;case"!contains":m=-1!=e.indexOf(cbHideFields[d][3]);break;case"in":var f=cbHideFields[d][3].toString().split("|*|");m=f.length>0?-1==f.indexOf(e):!0;break;case"!in":var f=cbHideFields[d][3].toString().split("|*|");m=f.length>0?-1!=f.indexOf(e):!1;break;case"regexp":var y=new RegExp(cbHideFields[d][3]);m=!y.test(e);break;case"!regexp":var y=new RegExp(cbHideFields[d][3]);m=y.test(e);break;case"evaluate":break;default:alert('js error operator "'+cbHideFields[d][2]+'" unknown.')}if("evaluate"==cbHideFields[d][2])"undefined"!=typeof cbPreviousOnChangeValues[cbHideFields[d][1]]&&cbPreviousOnChangeValues[cbHideFields[d][1]]!=e&&(o=!0),cbPreviousOnChangeValues[cbHideFields[d][1]]=e;else if(m){for(a=0;a<s.length;a++)for(r=0;r<cbHideFields[d][4].length;r++)cbHideFields[d][4][r]==s[a]&&s.splice(a,1);if(l=l.concat(cbHideFields[d][4]),cbHideFields[d][5].length>0&&"none"!=cbGetDisplayStyle(document.getElementById(cbHideFields[d][0])))for(a=0;a<cbHideFields[d][5].length;a++)t=cbHideFields[d][5][a].split("=",3),"none"!=cbGetDisplayStyle(document.getElementById(cbHideFields[d][4][0]))&&(n=document.getElementById(t[1]),"undefined"==typeof cbParamsSaveBefHide[d]&&(cbParamsSaveBefHide[d]=new Array),n?(cbParamsSaveBefHide[d][a]=n.value,n.value=t[2]):alert("InputToSet undefined: "+cbHideFields[d][4][0]))}else{for(c=!1,a=0;a<l.length;a++)for(r=0;r<cbHideFields[d][4].length;r++)cbHideFields[d][4][r]==l[a]&&(c=!0);if(!c&&(s=s.concat(cbHideFields[d][4]),cbHideFields[d][5].length>0))for(a=0;a<cbHideFields[d][5].length;a++)t=cbHideFields[d][5][a].split("=",3),"none"==cbGetDisplayStyle(document.getElementById(cbHideFields[d][4][0]))&&(n=document.getElementById(t[1]),"undefined"!=typeof cbParamsSaveBefHide[d]?n.value=cbParamsSaveBefHide[d][a]:alert("inputToSet saved param undefined for input id: "+t[1]+" as following id is hidden: "+cbHideFields[d][4][0]))}}if("undefined"==typeof cbjQuery){for(d=0;d<s.length;d++)i=document.getElementById(s[d]),i?"radio"==i.type||"checkbox"==i.type?i.parent.style.display="":(i.style.display="","option"==i.tagName.toLowerCase()&&(i.disabled=!1)):alert("field not found number: "+d+" id:"+s[d]);for(d=0;d<l.length;d++)i=document.getElementById(l[d]),i?"radio"==i.type||"checkbox"==i.type?(i.parent.style.display="none",i.checked=!1):(i.style.display="none","option"==i.tagName.toLowerCase()&&(i.selected=!1,i.disabled=!0)):alert("field not found number: "+d+" id:"+l[d])}else if(cbFirstTimeChange){for(d=0;d<s.length;d++)i=document.getElementById(s[d]),i&&("radio"==i.type||"checkbox"==i.type?jQuery(i.parentNode).show():(jQuery(i).show(),"option"==i.tagName.toLowerCase()&&jQuery(i).prop("disabled",!1)),jQuery(i).removeClass("cbDisplayDisabled"),jQuery(i).find("input,select,textarea").removeClass("cbValidationDisabled"));for(d=0;d<l.length;d++)i=document.getElementById(l[d]),i&&("radio"==i.type||"checkbox"==i.type?(jQuery(i.parentNode).hide(),jQuery(i).prop("checked",!1)):(jQuery(i).hide(),"option"==i.tagName.toLowerCase()&&(jQuery(i).prop("selected",!1),jQuery(i).prop("disabled",!0))),jQuery(i).addClass("cbDisplayDisabled"),jQuery(i).find("input,select,textarea").addClass("cbValidationDisabled"))}else{for(d=0;d<s.length;d++)i=document.getElementById(s[d]),i&&("radio"==i.type||"checkbox"==i.type?jQuery(i.parentNode).fadeIn("slow",function(){jQuery(this).show()}):(jQuery(i).fadeIn("slow",function(){jQuery(this).show()}),"option"==i.tagName.toLowerCase()&&jQuery(i).prop("disabled",!1)),jQuery(i).removeClass("cbDisplayDisabled"),jQuery(i).find("input,select,textarea").removeClass("cbValidationDisabled"));for(d=0;d<l.length;d++)i=document.getElementById(l[d]),i&&("radio"==i.type||"checkbox"==i.type?(jQuery(i.parentNode).fadeOut("slow",function(){jQuery(this).hide()}),jQuery(i).prop("checked",!1)):(jQuery(i).fadeOut("slow",function(){jQuery(this).hide()}),"option"==i.tagName.toLowerCase()&&(jQuery(i).prop("selected",!1),jQuery(i).prop("disabled",!0))),jQuery(i).addClass("cbDisplayDisabled"),jQuery(i).find("input,select,textarea").addClass("cbValidationDisabled"))}return cbFirstTimeChange=!1,o?(cbParentForm(this).submit(),!1):void 0}function cbInitFields(){if(cbW3CDOM&&("undefined"!=typeof overlib_pagedefaults&&overlib_pagedefaults(WIDTH,250,VAUTO,RIGHT,AUTOSTATUSCAP,CSSCLASS,TEXTFONTCLASS,"cb-tips-font",FGCLASS,"cb-tips-fg",BGCLASS,"cb-tips-bg",CAPTIONFONTCLASS,"cb-tips-capfont",CLOSEFONTCLASS,"cb-tips-closefont"),"undefined"!=typeof cbHideFields)){for(var e=0;e<cbHideFields.length;e++){var t=document.getElementById(cbHideFields[e][0]);if(null===t)alert("xml name "+cbHideFields[e][0]+" is undefined. It is cbHideFields["+e+"][0].");else{var n=document.getElementById(cbHideFields[e][1]),i=[];null!==n&&(i[0]=n),0==i.length&&(i=t.getElementsByTagName("input")),0==i.length&&(i=t.getElementsByTagName("select"));var d=1;cbSels[e]=new Array,cbSels[e][0]=t;for(var a=0;a<i.length;a++)"hidden"!=i[a].type&&("text"==i[a].type?cbAddEvent(i[a],"change",cbParamChange):cbAddEvent(i[a],window.ActiveXObject?"click":"change",cbParamChange),cbSels[e][d++]=i[a])}}cbParamChange()}}function CBgetHttpRequestInstance(){var e=!1;if(window.XMLHttpRequest)e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml");else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}return e}function CBmakeHttpRequest(e,t,n,i,d){function a(e){4==e.readyState&&(document.getElementById(t).innerHTML=200==e.status&&e.responseText.length>0&&e.responseText.length<1025?e.responseText:n.length>0?n:"",e=null)}return(arguments.length<5||null==d)&&(d=CBgetHttpRequestInstance()),d?(d.onreadystatechange=function(){a(d)},null==i?(d.open("GET",e,!0),d.send(null)):(d.open("POST",e,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.setRequestHeader("Content-length",i.length),d.send(i)),!0):!1}var cbW3CDOM=document.createElement&&document.getElementsByTagName,cbHideFields=new Array,cbParamsSaveBefHide=new Array,cbSels=new Array,cbPreviousOnChangeValues=new Array,cbFirstTimeChange=!0;cbAddEvent(window,"load",cbInitFields);